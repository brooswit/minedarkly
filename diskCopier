local on = false
local masterLabel = ""
local masterPath = ""
local targetPath = ""
local copied = false

while true do
  term.clear()
  on = redstone.getInput("front")
  if not on then
    term.write("Disk Copier: Off")
  else
    term.write("Disk Copier: On")
  end
  
  if not disk.isPresent("left") then
    term.write("Master Copy: Not Present. Insert master copy into left disk drive.")
    copied = false
  else
    term.write("Master Copy: " .. masterLabel .. " (Present)")
    masterLabel = disk.getLabel("left")
    masterPath = disk.getMountPath("left")
  end
  
  if not disk.isPresent("right") then
    term.write("Target Disk: Not Present. Insert target disk into right disk drive.")
    copied = false
  else
    term.write("Target Disk: " .. masterLabel .. " (Present)")
    targetPath = disk.getMountPath("right")
  end
  
  if not (masterPath and targetPath) then
    term.write("Not Ready")
  elseif not (on) then
    term.write("Ready")
  elseif not copied then
    term.write("Coping... Do not remove target disk...")
--    local targetFiles = fs.list(targetPath)
--    for _, targetFile in ipairs(targetFiles) do
--      targetFilePath = targetPath .. "/" .. targetFile
--      fs.delete(targetFilePath)
--    end
--    local masterFiles = fs.list(masterPath)
--    for _, masterFile in ipairs(masterFiles) do
--      masterFilePath = masterPath .. "/" .. masterFile
--      targetFilePath = targetPath .. "/" .. masterFile
--      fs.copy(masterFilePath, targetFilePath)
--    end
    copied = true
  else
    term.write("Copied! Remove target disk")
  end
end
